# WireGuard Docker ‚Äî —É–ø—Ä–∞–≤–ª—è–µ–º—ã–π VPN-—Å–µ—Ä–≤–µ—Ä –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–π WireGuard VPN-—Å–µ—Ä–≤–µ—Ä –Ω–∞ –±–∞–∑–µ Docker Compose —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π:
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞–º–∏ (`add`, `list`, `revoke`)
- –®–∞–±–ª–æ–Ω–Ω–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ñ–∏–≥–æ–≤
- –ü—Ä–æ—Å—Ç–æ–≥–æ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—è –∏ –ø–µ—Ä–µ–Ω–æ—Å–∞

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
wireguard-docker/
‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îú‚îÄ‚îÄ clients/           # –î—É–±–ª—å –∫–ª–∏–µ–Ω—Ç—Å–∫–∏—Ö –∫–æ–Ω—Ñ–∏–≥–æ–≤ –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
‚îÇ   ‚îú‚îÄ‚îÄ coredns/Corefile   # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è DNS-—Å–µ—Ä–≤–µ—Ä–∞ (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
‚îÇ   ‚îú‚îÄ‚îÄ scripts/           # –£—Ç–∏–ª–∏—Ç—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è: add, list, revoke
‚îÇ   ‚îú‚îÄ‚îÄ server/            # –ö–ª—é—á–∏ —Å–µ—Ä–≤–µ—Ä–∞ (–Ω–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—é—Ç—Å—è –≤ Git)
‚îÇ   ‚îú‚îÄ‚îÄ templates/         # –®–∞–±–ª–æ–Ω—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏ —Å–µ—Ä–≤–µ—Ä–∞
‚îÇ   ‚îî‚îÄ‚îÄ wg_confs/wg0.conf  # –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥ WireGuard (–Ω–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—é—Ç—Å—è –≤ Git)
‚îú‚îÄ‚îÄ docker-compose.yaml    # –û—Å–Ω–æ–≤–Ω–æ–π –º–∞–Ω–∏—Ñ–µ—Å—Ç —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—è
‚îú‚îÄ‚îÄ .env                   # –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (–ø—Ä–∏–º–µ—Ä –≤ .env.example)
‚îî‚îÄ‚îÄ README.md
```

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

1. **–°–∫–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π**
   ```bash
   git clone <your-repo-url>
   cd wireguard-docker
   ```

2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ**
   ```bash
   cp .env.example .env
   nano .env  # —É–∫–∞–∂–∏—Ç–µ –≤–∞—à –ø—É–±–ª–∏—á–Ω—ã–π IP, –ø–æ—Ä—Ç –∏ —Ç.–¥.
   ```

3. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ WireGuard**
   ```bash
   docker compose up -d
   ```

4. **–î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–≤–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞**
   ```bash
   docker compose exec wireguard add myclient > myclient.conf
   ```

5. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥ –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ**
   - –ò–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ `myclient.conf` –≤ WireGuard-–∫–ª–∏–µ–Ω—Ç
   - –ò–ª–∏ –æ—Ç—Å–∫–∞–Ω–∏—Ä—É–π—Ç–µ QR-–∫–æ–¥ –∏–∑ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞

---

## üîß –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞–º–∏

–í—Å–µ –∫–æ–º–∞–Ω–¥—ã –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —á–µ—Ä–µ–∑ `docker compose exec wireguard`:

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|--------|
| `add <name>` | –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞ –∏ –≤—ã–≤–µ—Å—Ç–∏ –∫–æ–Ω—Ñ–∏–≥ –≤ stdout |
| `list` | –ü–æ–∫–∞–∑–∞—Ç—å —Å–ø–∏—Å–æ–∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ |
| `revoke <name>` | –£–¥–∞–ª–∏—Ç—å –∫–ª–∏–µ–Ω—Ç–∞ –∏ –æ—Ç–æ–∑–≤–∞—Ç—å –¥–æ—Å—Ç—É–ø |

–ü—Ä–∏–º–µ—Ä:
```bash
docker compose exec wireguard add laptop
docker compose exec wireguard list
docker compose exec wireguard revoke old-phone
```

> üí° –ö–æ–Ω—Ñ–∏–≥–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞.

---

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### –û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã ‚Äî –≤ `.env`:
```ini
SERVERURL=your.public.ip.or.domain
SERVERPORT=51820
PEERDNS=1.1.1.1,1.0.0.1
ALLOWEDIPS=0.0.0.0/0,::/0
```

### –®–∞–±–ª–æ–Ω—ã
- `config/templates/peer.conf` ‚Äî —à–∞–±–ª–æ–Ω –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–≥–æ –∫–æ–Ω—Ñ–∏–≥–∞
- `config/templates/server.conf` ‚Äî (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) —à–∞–±–ª–æ–Ω —Å–µ—Ä–≤–µ—Ä–∞

---

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –ü—Ä–∏–≤–∞—Ç–Ω—ã–µ –∫–ª—é—á–∏ **–Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –ø–æ–ø–∞–¥–∞—é—Ç –≤ Git** (–∏—Å–∫–ª—é—á–µ–Ω—ã —á–µ—Ä–µ–∑ `.gitignore`)
- –í—Å–µ –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–µ –∫–æ–Ω—Ñ–∏–≥–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è **–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏**
- WireGuard —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–æ–º —Ä–µ–∂–∏–º–µ —Ç–æ–ª—å–∫–æ —Å –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–º–∏ `cap_add`

> ‚ö†Ô∏è –ù–µ –∫–æ–º–º–∏—Ç—å—Ç–µ `.env` —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ IP/DNS –≤ –ø—É–±–ª–∏—á–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π!

---

## üì¶ –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Docker Engine ‚â• 20.10
- Docker Compose ‚â• v2.0
- Linux-—Ö–æ—Å—Ç —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π `wireguard` (—è–¥—Ä–æ ‚â• 5.6 –∏–ª–∏ –º–æ–¥—É–ª—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)

---

## üìé –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- [WireGuard –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π —Å–∞–π—Ç](https://www.wireguard.com/)
- [linuxserver/wireguard –Ω–∞ Docker Hub](https://hub.docker.com/r/linuxserver/wireguard)
- [angristan/wireguard-install](https://github.com/angristan/wireguard-install) ‚Äî –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏–µ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞–º–∏

---

> ‚ú® –ü—Ä–æ–µ–∫—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω –¥–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã, –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏.  
> –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –ª–∏—á–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∏ enterprise-—Å—Ü–µ–Ω–∞—Ä–∏–µ–≤.
```

---

### üí° –°–æ–≤–µ—Ç—ã –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

- –ü–æ—Å–ª–µ –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è ‚Äî —Å—Ä–∞–∑—É –∑–∞–ø–æ–ª–Ω–∏—Ç–µ `.env`.
- –•—Ä–∞–Ω–∏—Ç–µ `clients/` –≤ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `age`, `gpg`, Vault).
- –î–ª—è CI/CD ‚Äî –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `add` —Å –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º:  
  ```bash
  docker compose exec wireguard add $CI_CLIENT > $CI_CLIENT.conf
  ```